{% extends 'base.html' %}
{% block title %}Training & Placement Cell{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-8">
    <a href="{% url 'student_dashboard' %}" class="inline-flex items-center text-blue-600 hover:text-blue-800 mb-6">
        <span class="mr-2">‚Üê</span> Back to Dashboard
    </a>
    <div class="bg-white rounded-xl shadow-lg p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">üíº Training & Placement Cell</h1>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <h3 class="font-bold text-lg text-gray-800 mb-4">Resume</h3>
                {% if resume %}
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                    <p class="text-gray-600">Last updated: {{ resume.uploaded_at|date:"M d, Y H:i" }}</p>
                    <div class="mt-3 space-y-2">
                        {% if resume_url %}
                        <div class="flex items-center space-x-3">
                            <a href="{{ resume_url }}" target="_blank" class="text-blue-600 underline">View Resume</a>
                            <span class="text-sm text-gray-600">(View)</span>
                        </div>
                        {% else %}
                        <div class="flex items-center space-x-3">
                            <span class="text-red-600">No resume uploaded or file missing</span>
                        </div>
                        {% endif %}
                        {% if resume.ats_score %}
                        <div class="mt-2">
                            <span class="text-xl font-bold">ATS Score: {{ resume.ats_score }}/100</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                <form method="POST" enctype="multipart/form-data" class="space-y-4">
                    {% csrf_token %}
                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Upload Resume (PDF)</label>
                        <input type="file" name="resume_file" accept=".pdf" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <p class="text-sm text-gray-600 mt-1">Upload your resume (single file). The system will analyze it for ATS score.</p>
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2">Job Description (optional)</label>
                        <textarea name="job_description" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Paste job description or key responsibilities here to analyze ATS match">{% if resume.job_description %}{{ resume.job_description }}{% endif %}</textarea>
                        <p class="text-sm text-gray-600 mt-1">Provide a job description so the ATS analyzer can compute a match score against your resume.</p>
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">10th Percentage (%)</label>
                            <input type="number" name="tenth_percentage" step="0.01" min="0" max="100"
                                value="{% if resume.tenth_percentage %}{{ resume.tenth_percentage }}{% endif %}"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2">12th Percentage (%)</label>
                            <input type="number" name="twelfth_percentage" step="0.01" min="0" max="100"
                                value="{% if resume.twelfth_percentage %}{{ resume.twelfth_percentage }}{% endif %}"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg">
                        </div>
                    </div>

                    <button type="submit" name="resume_submit"
                        class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition">
                        Upload & Analyze Resume
                    </button>
                </form>
            </div>

            <div>
                <h3 class="font-bold text-lg text-gray-800 mb-4">Academic Records</h3>

                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4">
                    <h4 class="font-semibold">Semester SGPAs</h4>
                    {% if semester_perfs %}
                        <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                            {% for sp in semester_perfs %}
                            <li>Semester {{ sp.semester }} ‚Äî SGPA: {{ sp.sgpa }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-sm text-gray-600">No SGPA records added yet.</p>
                    {% endif %}

                    <div class="mt-3">
                        <p class="font-semibold">CGPA</p>
                        {% if cgpa %}
                            <p class="text-xl font-bold text-blue-600">{{ cgpa }}</p>
                        {% else %}
                            <p class="text-sm text-gray-600">CGPA will be calculated once you add SGPAs.</p>
                        {% endif %}
                    </div>
                </div>

                <form method="POST" class="space-y-3">
                    {% csrf_token %}
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-gray-700">Semester (1-8)</label>
                            <input type="number" name="semester" min="1" max="8" required
                                class="w-full px-3 py-2 border border-gray-300 rounded">
                        </div>
                        <div>
                            <label class="block text-gray-700">SGPA (0.00 - 10.00)</label>
                            <input type="number" step="0.01" name="sgpa" min="0" max="10" required
                                class="w-full px-3 py-2 border border-gray-300 rounded">
                        </div>
                    </div>

                    <button type="submit" name="sgpa_submit" 
                        class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                        Add / Update SGPA
                    </button>
                </form>
            </div>
        </div>

        <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
            <h3 class="font-bold text-lg text-gray-800 mb-3">üí° ATS Score Breakdown</h3>
            <div class="space-y-2 text-gray-700">
                <p><strong>Technical Skills (30 points):</strong> Programming languages, frameworks, databases, DevOps tools, data science tools</p>
                <p><strong>Contact Information (10 points):</strong> Email address and phone number</p>
                <p><strong>Education (15 points):</strong> Degrees, institutions, academic achievements</p>
                <p><strong>Experience/Projects (20 points):</strong> Work experience, internships, projects, achievements</p>
                <p><strong>Soft Skills (10 points):</strong> Leadership, communication, teamwork, problem-solving</p>
                <p><strong>Certifications (10 points):</strong> Professional certifications and online courses</p>
                <p><strong>Formatting (5 points):</strong> Proper structure with clear sections</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}


<!-- Save all these templates in their respective directories -->